<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アメリカ主要都市 マップクイズ</title>
    <style>
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        #game-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        /* マップ表示エリア */
        #map-area {
            position: relative;
            width: 100%;
            /* 画像の読み込み遅延によるレイアウト崩れを防ぐため、アスペクト比を維持するか枠を確保 */
            min-height: 400px; 
            margin-bottom: 20px;
            border: 2px solid #ddd;
            overflow: hidden;
        }
        #us-map {
            width: 100%;
            height: auto;
            display: block;
        }
        /* 赤いピンのデザイン */
        .pin {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: red;
            border: 2px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%); /* 中心を座標に合わせる */
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            animation: pulse 1.5s infinite;
            cursor: pointer;
            z-index: 10;
        }
        /* ピンのアニメーション */
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
            70% { transform: translate(-50%, -50%) scale(1.2); box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); }
            100% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
        }

        /* クイズUI */
        #question-text {
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: bold;
        }
        #options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        button.option-btn {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 15px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button.option-btn:hover {
            background-color: #0056b3;
        }
        button.option-btn:disabled {
            background-color: #ccc;
            cursor: default;
        }
        /* 正解・不正解の色 */
        button.correct {
            background-color: #28a745 !important;
        }
        button.wrong {
            background-color: #dc3545 !important;
        }

        #score-board {
            margin-top: 15px;
            font-size: 1rem;
            color: #555;
        }
        #result-message {
            font-weight: bold;
            height: 1.5em; /* メッセージがない時も高さを確保 */
            margin-bottom: 10px;
            color: #333;
        }

    </style>
</head>
<body>

<div id="game-container">
    <h1>アメリカ都市当てクイズ</h1>
    <p>地図上の<span style="color:red; font-weight:bold;">赤いピン</span>が指している都市はどこでしょう？</p>
    
    <div id="score-board">正解数: <span id="score">0</span> / <span id="total">0</span></div>

    <div id="map-area">
        <img id="us-map" src="IMG_6534.jpg" alt="USA Map">
        <div id="target-pin" class="pin"></div>
    </div>

    <div id="result-message"></div>

    <div id="question-text">都市を選んでください:</div>
    <div id="options-container">
        </div>
</div>

<script>
    // 都市データ：座標（top, left）は画像の左上からのパーセンテージです。
    // ※画像の投影法に合わせて微調整が必要な場合があります。
    const cities = [
        { name: "シアトル", top: 6, left: 13 },
        { name: "サンフランシスコ", top: 34, left: 6 },
        { name: "ラスベガス", top: 41, left: 15 },
        { name: "ロサンゼルス", top: 48, left: 10 },
        { name: "サンディエゴ", top: 52, left: 12 },
        { name: "サンノゼ", top: 36, left: 7 }, // SFのすぐ南
        { name: "フェニックス", top: 53, left: 20 },
        { name: "エルパソ", top: 63, left: 30 },
        { name: "ダラス", top: 60, left: 47 },
        { name: "ヒューストン", top: 76, left: 49 },
        { name: "ニューオーリンズ", top: 76, left: 60 },
        { name: "マイアミ", top: 92, left: 81 },
        { name: "アトランタ", top: 62, left: 72 },
        { name: "セントルイス", top: 46, left: 60 },
        { name: "シカゴ", top: 33, left: 65 },
        { name: "デトロイト", top: 31, left: 73 },
        { name: "ピッツバーグ", top: 35, left: 80 },
        { name: "ボストン", top: 25, left: 93 },
        { name: "ニューヨーク", top: 30, left: 89 },
        { name: "フィラデルフィア", top: 34, left: 87 },
        { name: "ボルティモア", top: 37, left: 85 }, // DCの近く
        { name: "ワシントンDC", top: 39, left: 84 }
    ];

    let currentCity = null;
    let score = 0;
    let questionCount = 0;
    const totalQuestions = 10; // 1ゲームあたりの出題数（変更可能）

    // DOM要素
    const pin = document.getElementById('target-pin');
    const optionsContainer = document.getElementById('options-container');
    const resultMessage = document.getElementById('result-message');
    const scoreEl = document.getElementById('score');
    const totalEl = document.getElementById('total');

    // 配列をシャッフルする関数
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // 新しい問題をセットする
    function nextQuestion() {
        resultMessage.textContent = "";
        resultMessage.style.color = "#333";
        
        // ランダムに正解の都市を選ぶ
        currentCity = cities[Math.floor(Math.random() * cities.length)];

        // ピンの位置を移動
        pin.style.top = currentCity.top + "%";
        pin.style.left = currentCity.left + "%";

        // 選択肢の生成（正解1つ + 不正解3つ）
        let options = [currentCity];
        
        // 不正解の候補を作成（自分以外）
        let distractors = cities.filter(c => c.name !== currentCity.name);
        shuffleArray(distractors);
        
        // 不正解を3つ追加
        options.push(distractors[0], distractors[1], distractors[2]);
        
        // 選択肢の並び順をシャッフル
        shuffleArray(options);

        // ボタンを描画
        optionsContainer.innerHTML = "";
        options.forEach(city => {
            const btn = document.createElement('button');
            btn.className = "option-btn";
            btn.textContent = city.name;
            btn.onclick = () => checkAnswer(city, btn);
            optionsContainer.appendChild(btn);
        });
    }

    // 答え合わせ
    function checkAnswer(selectedCity, btnElement) {
        // すべてのボタンを無効化（連打防止）
        const buttons = document.querySelectorAll('.option-btn');
        buttons.forEach(b => b.disabled = true);

        if (selectedCity.name === currentCity.name) {
            // 正解
            btnElement.classList.add('correct');
            resultMessage.textContent = "正解！";
            resultMessage.style.color = "green";
            score++;
        } else {
            // 不正解
            btnElement.classList.add('wrong');
            resultMessage.textContent = `残念... 正解は「${currentCity.name}」でした。`;
            resultMessage.style.color = "red";
            
            // 正解のボタンを教えてあげる
            buttons.forEach(b => {
                if (b.textContent === currentCity.name) {
                    b.classList.add('correct');
                }
            });
        }

        questionCount++;
        scoreEl.textContent = score;
        totalEl.textContent = questionCount;

        // 次の問題へ（少し待ってから）
        setTimeout(() => {
            nextQuestion();
        }, 1500);
    }

    // 初期化
    nextQuestion();

</script>

</body>
</html>
